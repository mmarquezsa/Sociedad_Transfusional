<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9PCK9L8V77"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-9PCK9L8V77');
</script>
    
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sociedad Chilena de Medicina Transfusional | Transformando la medicina transfusional en Chile</title>
  <meta name="description" content="Líderes en medicina transfusional, inmunohematología y terapia celular. Promovemos la excelencia científica y la seguridad transfusional en Chile."/>
  <meta name="keywords" content="medicina transfusional, inmunohematología, hemoterapia, donación de sangre, seguridad transfusional, Chile, sociedad médica"/>

  <!-- Open Graph -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="SOCHIMT | Transformando la medicina transfusional en Chile"/>
  <meta property="og:description" content="Sociedad líder en medicina transfusional, promoviendo la excelencia científica y la seguridad del paciente."/>
  <meta property="og:image" content="https://www.sochimt.cl/img/og-image.jpg"/>
  <meta property="og:url" content="https://www.sochimt.cl"/>

  <!-- Favicons -->
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" sizes="180x180" />

  <!-- Tailwind CSS con configuración personalizada -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'sochimt': {
              50: '#eff6ff',
              100: '#dbeafe', 
              200: '#bfdbfe',
              300: '#93c5fd',
              400: '#60a5fa',
              500: '#3b82f6',
              600: '#2563eb',
              700: '#1d4ed8',
              800: '#1e40af',
              900: '#1e3a8a',
            },
            'medical': {
              50: '#fef2f2',
              100: '#fee2e2',
              200: '#fecaca', 
              300: '#fca5a5',
              400: '#f87171',
              500: '#ef4444',
              600: '#dc2626',
              700: '#b91c1c',
              800: '#991b1b',
              900: '#7f1d1d',
            }
          },
          fontFamily: {
            'sans': ['Inter', 'system-ui', 'sans-serif'],
          },
          animation: {
            'fade-in-up': 'fadeInUp 0.8s ease-out',
            'fade-in-down': 'fadeInDown 0.8s ease-out',
            'slide-in-right': 'slideInRight 0.8s ease-out',
            'pulse-slow': 'pulse 3s infinite',
            'bounce-gentle': 'bounceGentle 2s infinite',
          }
        }
      }
    }
  </script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
    
    body { 
      font-family: 'Inter', sans-serif;
      scroll-behavior: smooth;
    }
    
    /* Animaciones personalizadas */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes bounceGentle {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-10px); }
      60% { transform: translateY(-5px); }
    }
    
    /* Efectos visuales */
    .glass-morphism {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .gradient-mesh {
      background: linear-gradient(-45deg, #1e40af, #3b82f6, #dc2626, #ef4444);
      background-size: 400% 400%;
      animation: gradientShift 15s ease infinite;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    .text-gradient {
      background: linear-gradient(135deg, #1e40af, #dc2626);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    /* Hover effects */
    .card-hover {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .card-hover:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    /* Intersection Observer styles */
    .reveal {
      opacity: 0;
      transform: translateY(50px);
      transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .reveal.active {
      opacity: 1;
      transform: translateY(0);
    }
    
    /* Custom scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #f1f5f9; }
    ::-webkit-scrollbar-thumb { background: #1e40af; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #1d4ed8; }

    /* Mejoras responsive para móviles */
    @media (max-width: 768px) {
      .hero-title {
        font-size: 2.5rem !important;
        line-height: 1.1;
      }
      
      .hero-subtitle {
        font-size: 1.125rem !important;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 1rem !important;
      }
      
      .news-grid {
        grid-template-columns: 1fr !important;
      }
      
      .card-hover:hover {
        transform: translateY(-4px) scale(1.01);
      }
    }

    /* Fix para imágenes en móviles */
    .news-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      object-position: center;
    }

    /* Loading spinner mejorado */
    .loading-spinner {
      border: 3px solid #f3f4f6;
      border-top: 3px solid #2563eb;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body class="bg-gray-50 text-gray-900 overflow-x-hidden">
  
  <!-- Header/Navbar ultra moderno -->
  <header class="fixed top-0 w-full z-50 transition-all duration-300" id="navbar">
    <div class="glass-morphism">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center py-4">
          
<!-- Logo y marca -->
<div class="flex items-center space-x-4">
  <div class="relative">
    <div class="w-12 h-12 gradient-mesh rounded-xl flex items-center justify-center shadow-lg p-1">
      <img src="_ Main Logo 1.3.png" alt="SOCHIMT" class="w-full h-full object-cover rounded-lg" 
           onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
      <div class="hidden w-full h-full bg-white rounded-lg items-center justify-center">
        <span class="text-sochimt-600 font-bold text-sm">SM</span>
      </div>
    </div>
    <div class="absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full animate-pulse"></div>
  </div>
  <div class="hidden lg:block">
    <h1 class="text-xl font-bold text-gradient">SOCHIMT</h1>
    <p class="text-sm text-gray-600">Sociedad Chilena de Medicina Transfusional</p>
  </div>
</div>

           <!-- Navegación desktop -->
          <nav class="hidden lg:flex items-center space-x-8">
            <a href="#inicio" class="nav-link text-gray-700 hover:text-sochimt-600 font-medium transition-colors">Inicio</a>
            <a href="#quienes-somos" class="nav-link text-gray-700 hover:text-sochimt-600 font-medium transition-colors">Quiénes Somos</a>
            <a href="#servicios" class="nav-link text-gray-700 hover:text-sochimt-600 font-medium transition-colors">Servicios</a>
            <a href="#noticias" class="nav-link text-gray-700 hover:text-sochimt-600 font-medium transition-colors">Noticias</a>
            <a href="#socios" class="nav-link text-gray-700 hover:text-sochimt-600 font-medium transition-colors">Socios</a>
            <a href="#contacto" class="nav-link text-gray-700 hover:text-sochimt-600 font-medium transition-colors">Contacto</a>
          </nav>

          <!-- CTA Button -->
          <div class="hidden lg:flex items-center space-x-4">
            <a href="#socios" class="bg-gradient-to-r from-sochimt-600 to-sochimt-700 text-white px-6 py-3 rounded-full font-semibold hover:from-sochimt-700 hover:to-sochimt-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
              Únete Ahora
            </a>
          </div>

          <!-- Mobile menu button -->
          <button id="mobile-menu-btn" class="lg:hidden p-2 rounded-lg hover:bg-white/20 transition-colors">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="lg:hidden hidden">
      <div class="glass-morphism border-t border-white/20">
        <nav class="max-w-7xl mx-auto px-4 py-6 space-y-4">
          <a href="#inicio" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Inicio</a>
          <a href="#quienes-somos" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Quiénes Somos</a>
          <a href="#servicios" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Servicios</a>
          <a href="#areas-especializacion" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Especialización</a>
          <a href="#noticias" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Noticias</a>
          <a href="#socios" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Socios</a>
          <a href="#contacto" class="block py-2 text-gray-700 hover:text-sochimt-600 font-medium">Contacto</a>
          <a href="#socios" class="block mt-4 bg-gradient-to-r from-sochimt-600 to-sochimt-700 text-white px-6 py-3 rounded-full font-semibold text-center">
            Únete Ahora
          </a>
        </nav>
      </div>
    </div>
  </header>

  <!-- Hero Section ultra moderno -->
  <section id="inicio" class="relative min-h-screen flex items-center justify-center overflow-hidden">
    <!-- Background con gradiente animado -->
    <div class="absolute inset-0 gradient-mesh opacity-90"></div>
    
    <!-- Elementos decorativos flotantes -->
    <div class="absolute top-20 left-10 w-20 h-20 bg-white/10 rounded-full animate-bounce-gentle"></div>
    <div class="absolute top-40 right-20 w-16 h-16 bg-white/10 rounded-full animate-bounce-gentle" style="animation-delay: 1s;"></div>
    <div class="absolute bottom-40 left-20 w-12 h-12 bg-white/10 rounded-full animate-bounce-gentle" style="animation-delay: 2s;"></div>

    <!-- Contenido principal -->
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      
      <!-- Announcement Banner -->
      <div class="inline-flex items-center space-x-3 glass-morphism rounded-full px-6 py-3 mb-8 animate-fade-in-down">
        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
        <span class="text-white font-medium">Congreso Nacional</span>
        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
        </svg>
      </div>

      <!-- Título principal -->
    <h1 class="hero-title text-4xl md:text-6xl lg:text-7xl font-black text-white mb-8 animate-fade-in-up">
    Sociedad Chilena 
    <span class="block text-white">
      de 
    </span>
    Medicina Transfusional
    </h1>  

      <!-- Subtítulo -->
      <p class="hero-subtitle text-xl md:text-2xl text-white/90 mb-12 max-w-4xl mx-auto leading-relaxed animate-fade-in-up" style="animation-delay: 0.2s;">
        Construyendo el futuro de la medicina transfusional con ciencia y educación de vanguardia.
      </p>

<!-- Estadísticas impactantes -->
<div id="stats-section" class="stats-grid grid grid-cols-2 md:grid-cols-4 gap-8 mb-12 animate-fade-in-up" style="animation-delay: 0.4s;">
  <div class="text-center">
    <div class="text-3xl md:text-4xl font-black text-white mb-2">
      <span class="counter" data-target="100">0</span>+
    </div>
    <div class="text-white/80 text-sm uppercase tracking-wider">Socios Activos</div>
  </div>
  <div class="text-center">
    <div class="text-3xl md:text-4xl font-black text-white mb-2">
      <span class="counter" data-target="4">0</span>+
    </div>
    <div class="text-white/80 text-sm uppercase tracking-wider">Años de Historia</div>
  </div>
  <div class="text-center">
    <div class="text-3xl md:text-4xl font-black text-white mb-2">
      <span class="counter" data-target="1">0</span>+
    </div>
    <div class="text-white/80 text-sm uppercase tracking-wider">Publicaciones</div>
  </div>
  <div class="text-center">
    <div class="text-3xl md:text-4xl font-black text-white mb-2">
      <span class="counter" data-target="5">0</span>+
    </div>
    <div class="text-white/80 text-sm uppercase tracking-wider">Centros Asociados</div>
  </div>
</div>

      <!-- CTAs -->
      <div class="flex flex-col sm:flex-row items-center justify-center gap-6 animate-fade-in-up" style="animation-delay: 0.6s;">
        <a href="#quienes-somos" class="group bg-white text-sochimt-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-gray-50 transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-105 flex items-center space-x-2">
          <span>Descubre Más</span>
          <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </a>
        <a href="#socios" class="group bg-gradient-to-r from-sochimt-600 to-sochimt-700 text-white px-8 py-4 rounded-full font-bold text-lg hover:from-sochimt-700 hover:to-sochimt-800 transition-all duration-300 flex items-center space-x-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          <span>Únete como Socio</span>
        </a>
      </div>
    </div>

    <!-- Scroll indicator -->
    <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
      <svg class="w-6 h-6 text-white/70" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
      </svg>
    </div>
  </section>

<!-- Quiénes Somos - Inspirado en NTT DATA -->
<section id="quienes-somos" class="py-20 lg:py-32 bg-gray-50">
  

 <!-- Contenido principal -->
  <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      
    <!-- Header -->
    <div class="text-center mb-16 reveal">
      <span class="text-sochimt-600 font-semibold uppercase tracking-wider text-sm">Quiénes Somos</span>
      <h2 class="text-4xl lg:text-5xl font-black text-gray-900 mt-4 mb-6">
        Construyamos una Medicina Transfusional 
        <span class="text-gradient">mejor para Chile</span>
      </h2>
      <p class="text-xl text-gray-600 max-w-4xl mx-auto leading-relaxed">
        Somos una Sociedad Científica sin fines de lucro que reúne a técnicos/profesionales en Medicina Transfusional, Inmunohematología y Terapia celular de todo Chile, 
        con el objetivo de promover la formación continua, el intercambio de experiencias y la colaboración.
      </p>
    </div>

    <!-- Stats Grid -->
<div id="stats-section-about" class="stats-grid grid grid-cols-2 lg:grid-cols-4 gap-8 mb-20 reveal">
  <div class="text-center">
    <div class="text-4xl lg:text-5xl font-black text-sochimt-600 mb-2">
      <span class="counter" data-target="16">0</span>
    </div>
    <div class="text-gray-600 uppercase tracking-wider text-sm">Regiones de Chile</div>
  </div>
  <div class="text-center">
    <div class="text-4xl lg:text-5xl font-black text-sochimt-600 mb-2">
      <span class="counter" data-target="100">0</span>+
    </div>
    <div class="text-gray-600 uppercase tracking-wider text-sm">Profesionales</div>
  </div>
  <div class="text-center">
    <div class="text-4xl lg:text-5xl font-black text-sochimt-600 mb-2">
      <span class="counter" data-target="3">0</span>+
    </div>
    <div class="text-gray-600 uppercase tracking-wider text-sm">Años de Innovación</div>
  </div>
  <div class="text-center">
    <div class="text-4xl lg:text-5xl font-black text-sochimt-600 mb-2">
      <span class="counter" data-target="100">0</span>%
    </div>
    <div class="text-gray-600 uppercase tracking-wider text-sm">Seguridad</div>
  </div>
</div>

    <!-- Content Grid -->
    <div class="grid lg:grid-cols-2 gap-16 items-center">
      
      <!-- Text Content -->
      <div class="reveal">
        <div class="space-y-8">
          
          <!-- Misión -->
          <div class="bg-white/90 backdrop-blur-sm p-8 rounded-2xl border-l-4 border-sochimt-600 shadow-lg">
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 bg-sochimt-600 rounded-full flex items-center justify-center mr-4">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                </svg>
              </div>
              <h3 class="text-2xl font-bold text-gray-900">Nuestra Misión</h3>
            </div>
            <p class="text-gray-700 leading-relaxed">
              Promover el desarrollo y la excelencia de la Medicina Transfusional en Chile acercando tecnologías y terapias que transformen la forma de trabajar 
              en beneficio de quienes más lo necesitan. Nuestro deseo es que la medicina transfusional de Chile se convierta en un referente internacional, 
              reconocido por contribuir a la mejora de la salud de los pacientes.
            </p>
          </div>

          <!-- Visión -->
          <div class="bg-white/90 backdrop-blur-sm p-8 rounded-2xl border-l-4 border-medical-600 shadow-lg">
            <div class="flex items-center mb-4">
              <div class="w-12 h-12 bg-medical-600 rounded-full flex items-center justify-center mr-4">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                </svg>
              </div>
              <h3 class="text-2xl font-bold text-gray-900">Nuestra Visión</h3>
            </div>
            <p class="text-gray-700 leading-relaxed">
              Posicionar la Medicina Transfusional en Chile mediante la promoción de prácticas sustentadas en sistemas de calidad, 
              que garanticen la seguridad transfusional, integren nuevas tecnologías y fomenten el trabajo colaborativo y ético 
              entre los profesionales del área, apoyando el constante avance científico y tecnológico.
            </p>
          </div>

          <!-- CTA -->
          <div class="pt-6">
            <a href="#servicios" class="inline-flex items-center bg-gradient-to-r from-sochimt-600 to-sochimt-700 text-white px-8 py-4 rounded-full font-semibold hover:from-sochimt-700 hover:to-sochimt-800 transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 group">
              <span>Descubre nuestros servicios</span>
              <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
              </svg>
            </a>
          </div>
        </div>
      </div>

      <!-- Visual Content -->
      <div class="reveal">
        <div class="relative">
          <!-- Main image placeholder -->
          <div class="bg-gradient-to-br from-sochimt-600/80 to-medical-600/80 backdrop-blur-sm rounded-3xl h-96 flex items-center justify-center shadow-2xl transform rotate-3 hover:rotate-0 transition-transform duration-500">
            <div class="text-center text-white">
              <svg class="w-24 h-24 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"/>
              </svg>
              <h4 class="text-2xl font-bold mb-2">Laboratorio de Excelencia</h4>
              <p class="text-white/80">Tecnología de vanguardia</p>
            </div>
          </div>
          
          <!-- Decorative elements -->
          <div class="absolute -top-6 -right-6 w-24 h-24 bg-yellow-400/60 rounded-full animate-pulse-slow backdrop-blur-sm"></div>
          <div class="absolute -bottom-6 -left-6 w-32 h-32 bg-sochimt-400/40 rounded-full animate-pulse-slow backdrop-blur-sm" style="animation-delay: 1s;"></div>
        </div>
      </div>
    </div>
  </div>
</section>

  <!-- Noticias Dinámicas -->
  <section id="noticias" class="py-20 lg:py-32 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      
      <!-- Header -->
      <div class="text-center mb-16 reveal">
        <span class="text-sochimt-600 font-semibold uppercase tracking-wider text-sm">Últimas Noticias</span>
        <h2 class="text-4xl lg:text-5xl font-black text-gray-900 mt-4 mb-6">
          Mantente informado sobre
          <span class="text-gradient">nuestras actividades</span>
        </h2>
        <p class="text-xl text-gray-600 max-w-4xl mx-auto">
          Noticias, eventos, investigaciones y actualizaciones de la comunidad médica transfusional
        </p>
      </div>

      <!-- News Grid -->
      <div id="noticias-container" class="news-grid grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- Las noticias se cargarán dinámicamente -->
      </div>

      <!-- Loading State -->
      <div id="noticias-loading" class="text-center py-12">
        <div class="loading-spinner"></div>
        <p class="mt-4 text-gray-600">Cargando noticias...</p>
      </div>

      <!-- Error State -->
      <div id="noticias-error" class="text-center py-12 hidden">
        <div class="text-red-500 text-6xl mb-4">⚠️</div>
        <h3 class="text-lg font-medium text-gray-900 mb-2">Error cargando noticias</h3>
        <button onclick="loadNoticias()" class="px-6 py-2 bg-sochimt-600 text-white rounded-lg hover:bg-sochimt-700 transition-colors">
          Reintentar
        </button>
      </div>

      <!-- Ver más -->
      <div class="text-center mt-12 reveal">
        <a href="gestion_noticias.html" target="_blank" class="inline-flex items-center bg-gray-100 text-gray-700 px-8 py-4 rounded-full font-semibold hover:bg-gray-200 transition-all duration-300 group">
  <span>Gestionar Noticias</span>
  <svg class="w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
  </svg>
</a>
      </div>
    </div>
  </section>

 <!-- CTA Section / Sección Socios -->
<section id="socios" class="py-20 lg:py-32 gradient-mesh">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
    <div class="reveal">
      <h2 class="text-4xl lg:text-5xl font-black text-white mb-6">
        ¿Listo para transformar tu Desarrollo Profesional?
      </h2>  
      <p class="text-xl text-white/90 mb-12 max-w-3xl mx-auto">
        Únete a la comunidad líder en medicina transfusional de Chile y accede a recursos exclusivos, 
        formación continua y networking profesional de primer nivel.
      </p>
      <div class="flex flex-col sm:flex-row items-center justify-center gap-6">
        <a href="#contacto" class="bg-white text-sochimt-600 px-8 py-4 rounded-full font-bold text-lg hover:bg-gray-50 transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-105 flex items-center space-x-2 group">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
          </svg>
          <span>Hazte Socio Ahora</span>
        </a>
        <a href="#contacto" class="glass-morphism text-white px-8 py-4 rounded-full font-bold text-lg hover:bg-white/20 transition-all duration-300 flex items-center space-x-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
          </svg>
          <span>Contáctanos</span>
        </a>
      </div>
    </div>
  </div>
</section>

  <!-- Footer moderno -->
  <footer class="bg-gray-900 text-gray-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
        
        <!-- Logo y descripción -->
        <div class="lg:col-span-2">
          <div class="flex items-center space-x-4 mb-6">
            <div class="w-12 h-12 gradient-mesh rounded-xl flex items-center justify-center">
              <span class="text-white font-bold text-xl">SM</span>
            </div>
            <div>
              <h3 class="text-2xl font-bold text-white">SOCHIMT</h3>
              <p class="text-gray-400">Sociedad Chilena de Medicina Transfusional</p>
            </div>
          </div>
          <p class="text-gray-400 leading-relaxed mb-6 max-w-md">
            Transformando la Medicina Transfusional en Chile a través de la excelencia científica, 
            la educación continua y la innovación tecnológica.
          </p>
          
          <!-- Social Links -->
          <div class="flex space-x-4">
            <a href="https://www.instagram.com/sochimt_cl" target="_blank" class="w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-sochimt-600 transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.62 5.367 11.987 11.988 11.987 6.62 0 11.987-5.367 11.987-11.987C24.014 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.348-1.051-2.348-2.348s1.051-2.348 2.348-2.348c1.297 0 2.348 1.052 2.348 2.348S9.746 16.988 8.449 16.988zM16.988 8.449c0 1.297-1.051 2.348-2.348 2.348S12.292 9.746 12.292 8.449s1.051-2.348 2.348-2.348S16.988 7.152 16.988 8.449z"/>
              </svg>
            </a>
            <a href="https://www.facebook.com/profile.php?id=61575757064945" target="_blank" class="w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-sochimt-600 transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
            </a>
            <a href="#" class="w-10 h-10 bg-gray-800 rounded-lg flex items-center justify-center hover:bg-sochimt-600 transition-colors">
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814z"/>
              </svg>
            </a>
          </div>
        </div>

        <!-- Enlaces Rápidos -->
        <div>
          <h4 class="text-lg font-semibold text-white mb-6">Enlaces Rápidos</h4>
          <ul class="space-y-3">
            <li><a href="#quienes-somos" class="hover:text-white transition-colors">Quiénes Somos</a></li>
            <li><a href="#servicios" class="hover:text-white transition-colors">Servicios</a></li>
            <li><a href="#noticias" class="hover:text-white transition-colors">Noticias</a></li>
            <li><a href="#socios" class="hover:text-white transition-colors">Socios</a></li>
            <li><a href="contacto.html" class="hover:text-white transition-colors">Contacto</a></li>
          </ul>
        </div>

        <!-- Contacto -->
        <div>
          <h4 class="text-lg font-semibold text-white mb-6">Contacto</h4>
          <div class="space-y-3">
            <div class="flex items-center space-x-3">
              <svg class="w-5 h-5 text-sochimt-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
              </svg>
              <span>contacto@sochimt.cl</span>
            </div>
            <div class="flex items-center space-x-3">
              <svg class="w-5 h-5 text-sochimt-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
              </svg>
              <span>+56 9 7499 8376</span>
            </div>
            <div class="flex items-center space-x-3">
              <svg class="w-5 h-5 text-sochimt-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
              </svg>
              <span>Santiago, Chile</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom bar -->
      <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
        <p class="text-gray-400 text-sm">
          © 2025 Sociedad Chilena de Medicina Transfusional. Todos los derechos reservados.
        </p>
        <p class="text-gray-500 text-sm mt-4 md:mt-0">
          Desarrollado por Marcelo Márquez-Sandoval
        </p>
      </div>
    </div>
  </footer>

  <!-- Elementos de UI adicionales para móviles y sincronización -->
  <div id="loading-indicator" class="loading-indicator">
    <span>Actualizando...</span>
  </div>

  <!-- Indicador de estado de sincronización -->
  <div id="sync-status-indicator" class="sync-status">
    <div class="status-dot connected"></div>
    <span>Conectado</span>
  </div>

  <button id="mobile-refresh-btn" class="mobile-refresh tooltip" data-tooltip="Sincronizar con panel de gestión" title="Refrescar contenido">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
    </svg>
  </button>

  <!-- Botones de debug para desarrollo (ocultos por defecto) -->
  <div id="debug-controls" class="fixed bottom-20 left-4 space-y-2 opacity-20 hover:opacity-100 transition-opacity duration-300" style="display: none;">
    <button onclick="debugSOCHIMT()" class="bg-gray-600 text-white p-2 rounded-lg text-xs font-mono">Debug</button>
    <button onclick="testCommunication()" class="bg-blue-600 text-white p-2 rounded-lg text-xs font-mono">Test</button>
    <button onclick="forceCountersReset()" class="bg-purple-600 text-white p-2 rounded-lg text-xs font-mono">Reset</button>
  </div>

<!-- Scripts -->
<script>
  // Configuración global con mejor compatibilidad
  const CONFIG = {
    animations: {
      duration: 800,
      easing: 'cubic-bezier(0.4, 0, 0.2, 1)'
    },
    sync: {
      publicKey: 'sochimt_public_news',
      timestampKey: 'sochimt_last_sync',
      versionKey: 'sochimt_data_version',
      broadcastChannel: 'sochimt_updates',
      metaKey: 'sochimt_sync_meta'
    }
  };

  // Detección de dispositivo móvil
  const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

  // Variables globales
  let noticiasLoaded = false;
  let countersAnimated = {
    hero: false,
    about: false
  };
  let lastDataVersion = 0;
  let broadcastChannel = null;
  let autoSyncInterval = null;

  // Inicialización mejorada
  document.addEventListener('DOMContentLoaded', () => {
    console.log('🚀 Iniciando SOCHIMT v2.0...');
    
    // Inicializar componentes principales
    initNavbar();
    initMobileMenu();
    initScrollAnimations();
    initSmoothScrolling();
    initCounterAnimations();
    
    // Inicializar sistema de comunicación avanzado
    initAdvancedCommunication();
    
    // Cargar noticias con retry
    loadNoticiasWithRetry();
    
    // Forzar actualización de noticias en móviles
    if (isMobile) {
      setTimeout(() => {
        if (!noticiasLoaded) {
          console.log('🔄 Reintentando carga en móvil...');
          loadNoticiasWithRetry();
        }
      }, 2000);
      
      // Mostrar botón de refresh en móviles
      showMobileRefreshButton();
    }
    
    // Inicializar elementos de UI adicionales
    initUIElements();
    
    console.log('✅ SOCHIMT cargado exitosamente');
  });

  // Inicializar sistema de comunicación avanzado
  function initAdvancedCommunication() {
    // Inicializar BroadcastChannel si está disponible
    if (typeof BroadcastChannel !== 'undefined') {
      try {
        broadcastChannel = new BroadcastChannel(CONFIG.sync.broadcastChannel);
        broadcastChannel.onmessage = handleBroadcastMessage;
        console.log('📡 BroadcastChannel inicializado');
      } catch (error) {
        console.warn('No se pudo inicializar BroadcastChannel:', error);
      }
    }

    // Escuchar eventos personalizados
    window.addEventListener('sochimt_data_updated', handleDataUpdate);
    
    // Escuchar cambios en localStorage
    window.addEventListener('storage', handleStorageUpdate);
    
    // Verificar versión de datos inicial
    checkDataVersion();
    
    // Configurar auto-sync cada 15 segundos
    autoSyncInterval = setInterval(() => {
      checkForUpdates();
    }, 15000);
    
    console.log('🔄 Sistema de comunicación avanzado inicializado');
  }

  // Manejar mensajes del BroadcastChannel
  function handleBroadcastMessage(event) {
    console.log('📡 Mensaje recibido:', event.data);
    
    const { type, timestamp, user, action } = event.data;
    
    switch (type) {
      case 'news_updated':
        console.log(`📰 Noticias actualizadas por ${user} (${action || 'modificado'})`);
        showLoadingIndicator('🔄 Actualizando noticias...');
        setTimeout(() => {
          loadNoticiasWithRetry();
        }, 500);
        break;
        
      case 'news_deleted':
        console.log(`🗑️ Noticia eliminada por ${user}`);
        showLoadingIndicator('🔄 Sincronizando cambios...');
        setTimeout(() => {
          loadNoticiasWithRetry();
        }, 500);
        break;
    }
  }

  // Manejar eventos personalizados de actualización
  function handleDataUpdate(event) {
    console.log('📡 Evento de actualización recibido:', event.detail);
    
    if (event.detail && event.detail.noticias) {
      const newVersion = event.detail.version || 0;
      
      if (newVersion > lastDataVersion) {
        console.log(`🔄 Nueva versión detectada: ${newVersion} (actual: ${lastDataVersion})`);
        lastDataVersion = newVersion;
        showLoadingIndicator('✨ Contenido actualizado');
        loadNoticiasWithRetry();
      }
    }
  }

  // Manejar cambios en localStorage
  function handleStorageUpdate(event) {
    if (event.key === CONFIG.sync.publicKey && event.newValue) {
      console.log('💾 Cambio en localStorage detectado');
      showLoadingIndicator('🔄 Sincronizando...');
      setTimeout(() => {
        loadNoticiasWithRetry();
      }, 300);
    }
  }

  // Verificar versión de datos
  function checkDataVersion() {
    const savedVersion = localStorage.getItem(CONFIG.sync.versionKey);
    if (savedVersion) {
      lastDataVersion = parseInt(savedVersion);
    }
    
    const lastSync = localStorage.getItem(CONFIG.sync.timestampKey);
    if (lastSync) {
      const syncTime = new Date(parseInt(lastSync));
      console.log(`📊 Última sincronización: ${syncTime.toLocaleString('es-CL')}`);
    }
  }

  // Verificar actualizaciones automáticamente
  function checkForUpdates() {
    const currentVersion = localStorage.getItem(CONFIG.sync.versionKey);
    if (currentVersion && parseInt(currentVersion) > lastDataVersion) {
      console.log('🔄 Nueva versión disponible, actualizando...');
      lastDataVersion = parseInt(currentVersion);
      loadNoticiasWithRetry();
    }
  }

  // Inicializar elementos de UI
  function initUIElements() {
    const refreshBtn = document.getElementById('mobile-refresh-btn');
    const loadingIndicator = document.getElementById('loading-indicator');
    
    if (refreshBtn) {
      refreshBtn.addEventListener('click', () => {
        showLoadingIndicator();
        refreshNoticias();
        forceCountersReset();
      });
    }
  }

  // Mostrar botón de refresh en móviles
  function showMobileRefreshButton() {
    const refreshBtn = document.getElementById('mobile-refresh-btn');
    if (refreshBtn && isMobile) {
      setTimeout(() => {
        refreshBtn.classList.add('show');
      }, 3000); // Mostrar después de 3 segundos
    }
  }

  // Mostrar indicador de carga mejorado
  function showLoadingIndicator(text = 'Actualizando...', type = 'info') {
    const indicator = document.getElementById('loading-indicator');
    if (indicator) {
      // Limpiar clases anteriores
      indicator.className = 'loading-indicator show';
      
      // Agregar clase de tipo
      if (type === 'success') {
        indicator.classList.add('success');
      } else if (type === 'error') {
        indicator.classList.add('error');
      }
      
      indicator.textContent = text;
      
      // Auto-ocultar después de un tiempo
      const duration = type === 'error' ? 4000 : 2000;
      setTimeout(() => {
        indicator.classList.remove('show');
      }, duration);
    }
  });

  // Navbar con mejor rendimiento
  function initNavbar() {
    const navbar = document.getElementById('navbar');
    let lastScrollY = window.scrollY;
    let ticking = false;

    function updateNavbar() {
      const currentScrollY = window.scrollY;
      
      if (currentScrollY > 100) {
        navbar.style.backdropFilter = 'blur(20px)';
        navbar.style.backgroundColor = 'rgba(255, 255, 255, 0.95)';
      } else {
        navbar.style.backdropFilter = 'blur(10px)';
        navbar.style.backgroundColor = 'rgba(255, 255, 255, 0.1)';
      }

      // Auto-hide en móviles para mejor experiencia
      if (isMobile && currentScrollY > lastScrollY && currentScrollY > 200) {
        navbar.style.transform = 'translateY(-100%)';
      } else {
        navbar.style.transform = 'translateY(0)';
      }
      
      lastScrollY = currentScrollY;
      ticking = false;
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateNavbar);
        ticking = true;
      }
    });
  }

  // Mobile menu mejorado
  function initMobileMenu() {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');

    if (!mobileMenuBtn || !mobileMenu) return;

    mobileMenuBtn.addEventListener('click', (e) => {
      e.preventDefault();
      mobileMenu.classList.toggle('hidden');
    });

    // Cerrar al hacer clic en un enlace
    mobileMenu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        mobileMenu.classList.add('hidden');
      });
    });

    // Cerrar al hacer clic fuera del menú
    document.addEventListener('click', (e) => {
      if (!mobileMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
        mobileMenu.classList.add('hidden');
      }
    });
  }

  // Smooth scrolling mejorado
  function initSmoothScrolling() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const targetId = this.getAttribute('href');
        const target = document.querySelector(targetId);
        
        if (target) {
          const offsetTop = target.offsetTop - 80; // Account for fixed navbar
          window.scrollTo({
            top: offsetTop,
            behavior: 'smooth'
          });
        }
      });
    });
  }

  // Animaciones de scroll con mejor rendimiento
  function initScrollAnimations() {
    if (!window.IntersectionObserver) {
      // Fallback para navegadores antiguos
      document.querySelectorAll('.reveal').forEach(el => {
        el.classList.add('active');
      });
      return;
    }

    const observerOptions = {
      root: null,
      rootMargin: '0px 0px -50px 0px',
      threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    document.querySelectorAll('.reveal').forEach(el => {
      observer.observe(el);
    });
  }

  // Sistema de contadores simplificado y más confiable
  function initCounterAnimations() {
    // Usar un setTimeout para asegurarse de que el DOM esté completamente cargado
    setTimeout(() => {
      console.log('🔢 Iniciando animación de contadores...');
      
      // Encontrar todos los contadores en la página
      const allCounters = document.querySelectorAll('.counter');
      console.log(`📊 Encontrados ${allCounters.length} contadores`);
      
      if (allCounters.length === 0) {
        console.warn('⚠️ No se encontraron contadores en la página');
        return;
      }
      
      // Configurar Intersection Observer
      const observerOptions = {
        root: null,
        rootMargin: '0px 0px -20px 0px',
        threshold: 0.1
      };

      const counterObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const section = entry.target;
            const counters = section.querySelectorAll('.counter');
            
            console.log(`🎯 Sección visible: ${section.id}, contadores: ${counters.length}`);
            
            counters.forEach((counter, index) => {
              // Pequeño delay entre contadores para efecto visual
              setTimeout(() => {
                animateCounter(counter);
              }, index * 200);
            });
            
            // Desconectar después de animar
            counterObserver.unobserve(section);
          }
        });
      }, observerOptions);

      // Observar secciones que contienen contadores
      const sectionsWithCounters = [
        document.getElementById('stats-section'),
        document.getElementById('stats-section-about')
      ].filter(Boolean);

      sectionsWithCounters.forEach(section => {
        console.log(`👀 Observando sección: ${section.id}`);
        counterObserver.observe(section);
      });

      // Fallback: Si no hay Intersection Observer, animar después de un tiempo
      if (!window.IntersectionObserver) {
        console.log('📱 Intersection Observer no disponible, usando fallback');
        setTimeout(() => {
          allCounters.forEach(counter => animateCounter(counter));
        }, 2000);
      }
      
    }, 1000); // Esperar 1 segundo después de que el DOM esté listo
  }

  // Función de animación de contador mejorada
  function animateCounter(element) {
    const target = parseInt(element.getAttribute('data-target'));
    const duration = isMobile ? 1200 : 1800; // Más rápido en móviles
    const startTime = performance.now();
    
    console.log(`🎬 Animando contador hacia: ${target}`);
    
    function updateCounter(currentTime) {
      const elapsed = currentTime - startTime;
      const progress = Math.min(elapsed / duration, 1);
      
      // Usar easing para animación más suave
      const easeOutQuart = 1 - Math.pow(1 - progress, 4);
      const currentValue = Math.floor(target * easeOutQuart);
      
      element.textContent = currentValue;
      
      if (progress < 1) {
        requestAnimationFrame(updateCounter);
      } else {
        element.textContent = target;
        console.log(`✅ Contador animado completamente: ${target}`);
      }
    }
    
    requestAnimationFrame(updateCounter);
  }

  // Carga de noticias con sistema de retry más robusto
  async function loadNoticiasWithRetry(maxRetries = 2) {
    const container = document.getElementById('noticias-container');
    const loading = document.getElementById('noticias-loading');
    const errorDiv = document.getElementById('noticias-error');

    console.log('🔄 Iniciando carga de noticias...');

    try {
      // Mostrar loading solo si no hay contenido
      if (container && container.innerHTML.trim() === '') {
        if (loading) loading.style.display = 'block';
        if (errorDiv) errorDiv.style.display = 'none';
      }

      // Intentar cargar noticias con timeout
      const noticias = await Promise.race([
        fetchNoticias(),
        new Promise((_, reject) => 
          setTimeout(() => reject(new Error('Timeout')), 5000)
        )
      ]);
      
      if (!Array.isArray(noticias) || noticias.length === 0) {
        console.warn('⚠️ No se encontraron noticias, usando datos por defecto');
        const defaultNews = getDefaultNoticias();
        renderNoticias(defaultNews);
      } else {
        console.log(`✅ ${noticias.length} noticias cargadas exitosamente`);
        renderNoticias(noticias);
      }
      
      noticiasLoaded = true;
      
    } catch (error) {
      console.error('❌ Error cargando noticias:', error);
      
      // En caso de error, mostrar noticias por defecto
      const defaultNews = getDefaultNoticias();
      renderNoticias(defaultNews);
      noticiasLoaded = true;
    }
  }

  // Renderizar noticias separado para mejor control
  function renderNoticias(noticias) {
    const container = document.getElementById('noticias-container');
    const loading = document.getElementById('noticias-loading');
    const errorDiv = document.getElementById('noticias-error');

    try {
      // Ocultar loading
      if (loading) loading.style.display = 'none';
      if (errorDiv) errorDiv.style.display = 'none';
      
      if (!container) {
        console.error('❌ Container de noticias no encontrado');
        return;
      }

      // Renderizar noticias
      container.innerHTML = noticias.map(noticia => createNoticiaHTML(noticia)).join('');
      
      // Aplicar animaciones con delay para móviles
      const reveals = container.querySelectorAll('.reveal');
      reveals.forEach((el, index) => {
        setTimeout(() => {
          el.classList.add('active');
        }, isMobile ? index * 50 : index * 100);
      });

      console.log(`🎨 ${noticias.length} noticias renderizadas correctamente`);

    } catch (error) {
      console.error('❌ Error renderizando noticias:', error);
      if (container) {
        container.innerHTML = `
          <div class="text-center py-12">
            <div class="text-red-500 text-6xl mb-4">⚠️</div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Error mostrando noticias</h3>
            <p class="text-gray-600 mb-4">Por favor, recarga la página</p>
            <button onclick="location.reload()" class="px-6 py-2 bg-sochimt-600 text-white rounded-lg hover:bg-sochimt-700 transition-colors">
              Recargar Página
            </button>
          </div>
        `;
      }
    }
  }

  // Cargar noticias mejorado
  async function loadNoticias() {
    const container = document.getElementById('noticias-container');
    const loading = document.getElementById('noticias-loading');
    const errorDiv = document.getElementById('noticias-error');

    if (!container || !loading) {
      throw new Error('Elementos de noticias no encontrados');
    }

    try {
      // Mostrar loading
      loading.style.display = 'block';
      errorDiv.style.display = 'none';
      
      const noticias = await fetchNoticias();
      
      if (!Array.isArray(noticias) || noticias.length === 0) {
        throw new Error('No hay noticias disponibles');
      }
      
      // Ocultar loading
      loading.style.display = 'none';
      
      // Renderizar noticias
      container.innerHTML = noticias.map(noticia => createNoticiaHTML(noticia)).join('');
      
      // Aplicar animaciones con delay para móviles
      const reveals = container.querySelectorAll('.reveal');
      reveals.forEach((el, index) => {
        setTimeout(() => {
          el.classList.add('active');
        }, isMobile ? index * 50 : index * 100);
      });

      console.log(`✅ ${noticias.length} noticias cargadas exitosamente`);

    } catch (error) {
      console.error('Error en loadNoticias:', error);
      throw error;
    }
  }

  // Mostrar error de noticias
  function showNoticiasError() {
    const loading = document.getElementById('noticias-loading');
    const errorDiv = document.getElementById('noticias-error');
    
    if (loading) loading.style.display = 'none';
    if (errorDiv) errorDiv.style.display = 'block';
  }

  // Función fetchNoticias simplificada y más robusta
  async function fetchNoticias() {
    try {
      console.log('📰 Buscando noticias...');
      
      // 1. Primero intentar datos de sincronización recientes
      const syncMeta = getSyncMetadata();
      if (syncMeta && syncMeta.noticias && Array.isArray(syncMeta.noticias) && syncMeta.noticias.length > 0) {
        console.log(`📰 Encontradas ${syncMeta.noticias.length} noticias del sistema de sync`);
        return syncMeta.noticias;
      }
      
      // 2. Luego intentar localStorage principal
      const localData = getValidLocalStorageData();
      if (localData && localData.length > 0) {
        console.log(`📰 Encontradas ${localData.length} noticias en localStorage`);
        return localData;
      }
      
      // 3. Como último recurso, usar noticias por defecto
      console.log('📰 Usando noticias por defecto');
      return getDefaultNoticias();
      
    } catch (error) {
      console.error('❌ Error en fetchNoticias:', error);
      return getDefaultNoticias();
    }
  }

  // Obtener metadata de sincronización
  function getSyncMetadata() {
    try {
      const metaData = localStorage.getItem(CONFIG.sync.metaKey);
      if (metaData) {
        const parsed = JSON.parse(metaData);
        
        // Verificar que los datos no sean muy antiguos (máximo 1 hora)
        const oneHourAgo = Date.now() - (60 * 60 * 1000);
        if (parsed.lastUpdate && parsed.lastUpdate > oneHourAgo) {
          return parsed;
        }
      }
    } catch (error) {
      console.warn('Error obteniendo metadata de sync:', error);
    }
    return null;
  }

  // Verificar actualizaciones desde gestión de noticias
  function checkForNewsUpdate() {
    try {
      // Escuchar eventos de actualización en tiempo real
      window.addEventListener('newsUpdated', (event) => {
        console.log('🔄 Noticias actualizadas desde gestión');
        if (event.detail && event.detail.news) {
          saveToLocalStorage(event.detail.news);
          loadNoticiasWithRetry(); // Recargar automáticamente
        }
      });

      // Verificar si hay datos pendientes de actualización
      const pendingUpdate = localStorage.getItem('sochimt_pending_update');
      if (pendingUpdate) {
        console.log('🔄 Procesando actualización pendiente');
        const data = JSON.parse(pendingUpdate);
        localStorage.removeItem('sochimt_pending_update');
        saveToLocalStorage(data);
        return data;
      }

      return null;
    } catch (error) {
      console.warn('Error verificando actualizaciones:', error);
      return null;
    }
  }

  // Guardar en localStorage de forma segura
  function saveToLocalStorage(data) {
    try {
      if (typeof(Storage) !== "undefined" && Array.isArray(data)) {
        localStorage.setItem(CONFIG.sync.publicKey, JSON.stringify(data));
        console.log('💾 Noticias guardadas en localStorage');
        
        // Disparar evento para sincronización
        window.dispatchEvent(new CustomEvent('newsSaved', { 
          detail: { 
            count: data.length,
            timestamp: Date.now() 
          } 
        }));
      }
    } catch (error) {
      console.error('Error guardando en localStorage:', error);
    }
  }

  // Función para refrescar noticias (llamada externa)
  window.refreshNoticias = function() {
    console.log('🔄 Refrescando noticias...');
    noticiasLoaded = false;
    showLoadingIndicator('🔄 Actualizando contenido...');
    loadNoticiasWithRetry();
  };

  // Función para obtener estado actual
  window.getNoticiasStatus = function() {
    const localData = getValidLocalStorageData();
    const syncMeta = getSyncMetadata();
    
    return {
      loaded: noticiasLoaded,
      count: localData ? localData.length : 0,
      isMobile: isMobile,
      hasLocalStorage: typeof(Storage) !== "undefined",
      lastDataVersion: lastDataVersion,
      hasBroadcastChannel: !!broadcastChannel,
      syncMeta: syncMeta ? {
        lastUpdate: syncMeta.lastUpdate,
        version: syncMeta.version,
        generatedBy: syncMeta.generatedBy
      } : null
    };
  };

  // Función para forzar sincronización desde el panel
  window.forceSyncFromPanel = function() {
    console.log('📡 Forzando sincronización desde panel...');
    showLoadingIndicator('📡 Sincronizando con panel...');
    
    // Enviar mensaje al panel si está abierto
    if (broadcastChannel) {
      broadcastChannel.postMessage({
        type: 'request_sync',
        timestamp: Date.now(),
        source: 'website'
      });
    }
    
    // Recargar datos después de un momento
    setTimeout(() => {
      loadNoticiasWithRetry();
    }, 1000);
  };

  // Validar datos del localStorage con mejor detección
  function getValidLocalStorageData() {
    try {
      if (typeof(Storage) === "undefined") {
        console.warn('LocalStorage no soportado');
        return null;
      }

      // Intentar cargar datos de múltiples fuentes
      let data = localStorage.getItem(CONFIG.sync.publicKey);
      
      if (!data) {
        // Intentar fuente alternativa (para compatibilidad)
        data = localStorage.getItem('sochimt_public_news');
      }
      
      if (!data) return null;

      const parsed = JSON.parse(data);
      
      // Validar estructura de datos
      if (!Array.isArray(parsed)) return null;
      
      const validatedNews = parsed.filter(noticia => 
        noticia && 
        typeof noticia.titulo === 'string' && 
        typeof noticia.fecha === 'string' &&
        typeof noticia.resumen === 'string' &&
        noticia.titulo.length > 0 &&
        noticia.resumen.length > 0
      );
      
      if (validatedNews.length !== parsed.length) {
        console.warn(`⚠️ Algunas noticias fueron filtradas: ${parsed.length} -> ${validatedNews.length}`);
      }
      
      return validatedNews;
      
    } catch (error) {
      console.warn('Error validando localStorage:', error);
      return null;
    }
  }

  // Noticias por defecto garantizadas
  function getDefaultNoticias() {
    console.log('📰 Generando noticias por defecto...');
    
    return [
      {
        id: 'default-1',
        titulo: 'Bienvenidos a SOCHIMT',
        fecha: '15 de junio de 2025',
        resumen: 'La Sociedad Chilena de Medicina Transfusional da la bienvenida a todos los profesionales del área. Estamos comprometidos con la excelencia y la seguridad en medicina transfusional.',
        categoria: 'Noticia',
        imagen: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjM0I4MkY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSIyNCIgZm9udC1mYW1pbHk9IkludGVyLCBzYW5zLXNlcmlmIj5TT0NISU1UPC90ZXh0Pgo8L3N2Zz4=',
        url: '#quienes-somos'
      },
      {
        id: 'default-2',
        titulo: 'Panel de Administración',
        fecha: 'Disponible',
        resumen: 'Los administradores pueden gestionar noticias a través del panel de administración. Contacta al equipo para obtener acceso.',
        categoria: 'Noticia',
        imagen: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMDU5NjY5Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSIyMCIgZm9udC1mYW1pbHk9IkludGVyLCBzYW5zLXNlcmlmIj5QYSW5lbCBBZG1pbjwvdGV4dD4KPC9zdmc+',
        url: 'gestion_noticias.html'
      },
      {
        id: 'default-3',
        titulo: 'Próximas Actividades',
        fecha: 'Por confirmar',
        resumen: 'Mantente atento a nuestro calendario de eventos, webinars y actividades de formación continua.',
        categoria: 'Evento',
        imagen: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjU5RTBCIi8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1zaXplPSIyMCIgZm9udC1mYW1pbHk9IkludGVyLCBzYW5zLXNlcmlmIj5Qcsw7eGltYW1lbnRlPC90ZXh0Pgo8L3N2Zz4=',
        url: '#socios'
      }
    ];
  }

  // Función simplificada para refrescar noticias
  window.refreshNoticias = function() {
    console.log('🔄 Refrescando noticias manualmente...');
    
    const container = document.getElementById('noticias-container');
    const loading = document.getElementById('noticias-loading');
    
    // Mostrar indicador
    showLoadingIndicator('🔄 Actualizando contenido...', 'info');
    
    // Limpiar contenido actual
    if (container) {
      container.innerHTML = '';
    }
    
    // Resetear estado
    noticiasLoaded = false;
    
    // Recargar
    setTimeout(() => {
      loadNoticiasWithRetry();
    }, 500);
  };

  // Función simplificada para resetear contadores
  window.forceCountersReset = function() {
    console.log('🔄 Reiniciando contadores manualmente...');
    
    // Resetear variables de estado
    countersAnimated = { hero: false, about: false };
    
    // Encontrar y resetear todos los contadores
    const allCounters = document.querySelectorAll('.counter');
    console.log(`🔢 Reseteando ${allCounters.length} contadores`);
    
    allCounters.forEach(counter => {
      counter.textContent = '0';
    });
    
    // Mostrar feedback
    showLoadingIndicator('🔄 Contadores reiniciados', 'success');
    
    // Reinicializar después de un momento
    setTimeout(() => {
      initCounterAnimations();
    }, 500);
  };

  // Crear HTML para noticia con mejores imágenes responsivas
  function createNoticiaHTML(noticia) {
    const categoryColors = {
      'Evento': 'bg-blue-100 text-blue-800',
      'Publicación': 'bg-green-100 text-green-800',
      'Noticia': 'bg-purple-100 text-purple-800',
      'Webinar': 'bg-purple-100 text-purple-800',
      'Congreso': 'bg-red-100 text-red-800'
    };

    // Validar imagen
    const imageUrl = noticia.imagen || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmaWxsPSIjNkI3Mjg0IiBmb250LXNpemU9IjE4IiBmb250LWZhbWlseT0iSW50ZXIsIHNhbnMtc2VyaWYiPkltYWdlbjwvdGV4dD4KPC9zdmc+';

    return `
      <article class="bg-white rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 card-hover reveal overflow-hidden">
        <div class="relative">
          <img src="${imageUrl}" 
               alt="${noticia.titulo}" 
               class="news-image"
               loading="lazy"
               onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDQwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+Cjx0ZXh0IHg9IjIwMCIgeT0iMTAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiBmaWxsPSIjNkI3Mjg0IiBmb250LXNpemU9IjE4IiBmb250LWZhbWlseT0iSW50ZXIsIHNhbnMtc2VyaWYiPkltYWdlbjwvdGV4dD4KPC9zdmc+'">
          <div class="absolute top-4 left-4">
            <span class="px-3 py-1 ${categoryColors[noticia.categoria] || 'bg-gray-100 text-gray-800'} rounded-full text-sm font-medium">
              ${noticia.categoria || 'General'}
            </span>
          </div>
        </div>
        <div class="p-6">
          <div class="flex items-center text-sm text-gray-500 mb-3">
            <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
            ${noticia.fecha}
          </div>
          <h3 class="text-xl font-bold text-gray-900 mb-3 hover:text-sochimt-600 transition-colors line-clamp-2">
            ${noticia.titulo}
          </h3>
          <p class="text-gray-600 leading-relaxed mb-4 line-clamp-3">
            ${noticia.resumen}
          </p>
          <a href="${noticia.url || '#'}" 
             ${noticia.url && noticia.url !== '#' ? 'target="_blank" rel="noopener noreferrer"' : ''} 
             class="inline-flex items-center text-sochimt-600 font-semibold hover:text-sochimt-700 transition-colors group">
            <span>Leer más</span>
            <svg class="w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </a>
        </div>
      </article>
    `;
  }

  // Función para debug en consola
  window.debugSOCHIMT = function() {
    console.log('🔍 Debug SOCHIMT v2.0:');
    console.log('- Es móvil:', isMobile);
    console.log('- Noticias cargadas:', noticiasLoaded);
    console.log('- Contadores animados:', countersAnimated);
    console.log('- LocalStorage disponible:', typeof(Storage) !== "undefined");
    console.log('- BroadcastChannel activo:', !!broadcastChannel);
    console.log('- Versión de datos actual:', lastDataVersion);
    
    const localData = getValidLocalStorageData();
    console.log('- Noticias en localStorage:', localData ? localData.length : 0);
    
    const syncMeta = getSyncMetadata();
    if (syncMeta) {
      console.log('- Metadata de sincronización:');
      console.log('  * Última actualización:', new Date(syncMeta.lastUpdate).toLocaleString('es-CL'));
      console.log('  * Versión:', syncMeta.version);
      console.log('  * Generado por:', syncMeta.generatedBy);
      console.log('  * Noticias disponibles:', syncMeta.noticias ? syncMeta.noticias.length : 0);
    }
    
    // Verificar elementos DOM
    const statsSection = document.getElementById('stats-section');
    const statsSectionAbout = document.getElementById('stats-section-about');
    console.log('- Sección stats hero encontrada:', !!statsSection);
    console.log('- Sección stats about encontrada:', !!statsSectionAbout);
    
    if (statsSection) {
      const counters = statsSection.querySelectorAll('.counter');
      console.log('- Contadores en hero:', counters.length);
      console.log('- Valores actuales:', Array.from(counters).map(c => c.textContent));
    }
    
    if (statsSectionAbout) {
      const counters = statsSectionAbout.querySelectorAll('.counter');
      console.log('- Contadores en about:', counters.length);
      console.log('- Valores actuales:', Array.from(counters).map(c => c.textContent));
    }
    
    // Test de comunicación con gestión
    const testData = localStorage.getItem('sochimt_public_news');
    const testMeta = localStorage.getItem('sochimt_sync_meta');
    console.log('- Datos de gestión disponibles:', !!testData);
    console.log('- Metadata de gestión disponible:', !!testMeta);
    
    // Información de conectividad
    console.log('- Conexión online:', navigator.onLine);
    console.log('- User Agent:', navigator.userAgent.substring(0, 50) + '...');
    
    return {
      mobile: isMobile,
      noticiasLoaded,
      countersAnimated,
      localStorageData: localData?.length || 0,
      hasManagementData: !!testData,
      broadcastChannelActive: !!broadcastChannel,
      lastDataVersion,
      syncMetadata: syncMeta,
      online: navigator.onLine
    };
  };

  // Función para forzar reanimación de contadores
  window.forceCountersReset = function() {
    console.log('🔄 Reiniciando contadores...');
    countersAnimated = { hero: false, about: false };
    
    // Reiniciar valores a 0
    document.querySelectorAll('.counter').forEach(counter => {
      counter.textContent = '0';
    });
    
    // Reinicializar observador
    setTimeout(() => {
      initCounterAnimations();
    }, 100);
    
    showLoadingIndicator('🔄 Contadores reiniciados');
  };

  // Función para test de comunicación
  window.testCommunication = function() {
    console.log('🧪 Iniciando test de comunicación...');
    
    const tests = [];
    
    // Test 1: LocalStorage
    try {
      localStorage.setItem('sochimt_test', 'test');
      const value = localStorage.getItem('sochimt_test');
      localStorage.removeItem('sochimt_test');
      tests.push({ name: 'LocalStorage', passed: value === 'test' });
    } catch (e) {
      tests.push({ name: 'LocalStorage', passed: false, error: e.message });
    }
    
    // Test 2: BroadcastChannel
    tests.push({ 
      name: 'BroadcastChannel', 
      passed: !!broadcastChannel,
      note: broadcastChannel ? 'Activo' : 'No disponible'
    });
    
    // Test 3: Custom Events
    try {
      const event = new CustomEvent('sochimt_test');
      window.dispatchEvent(event);
      tests.push({ name: 'Custom Events', passed: true });
    } catch (e) {
      tests.push({ name: 'Custom Events', passed: false, error: e.message });
    }
    
    // Test 4: Datos de sincronización
    const syncData = getSyncMetadata();
    tests.push({ 
      name: 'Sync Data', 
      passed: !!syncData,
      note: syncData ? `${syncData.noticias?.length || 0} noticias` : 'Sin datos'
    });
    
    console.table(tests);
    
    if (broadcastChannel) {
      console.log('📡 Enviando mensaje de test...');
      broadcastChannel.postMessage({
        type: 'test_message',
        timestamp: Date.now(),
        source: 'website',
        message: 'Test de comunicación desde sitio web'
      });
    }
    
    return tests;
  };

  // Función para limpiar datos y reiniciar
  window.resetSOCHIMT = function() {
    console.log('🗑️ Limpiando datos y reiniciando...');
    
    // Limpiar localStorage
    const keysToRemove = [
      'sochimt_public_news',
      'sochimt_sync_meta', 
      'sochimt_last_sync',
      'sochimt_data_version',
      'sochimt_pending_update'
    ];
    
    keysToRemove.forEach(key => {
      localStorage.removeItem(key);
    });
    
    // Reiniciar variables
    noticiasLoaded = false;
    lastDataVersion = 0;
    countersAnimated = { hero: false, about: false };
    
    // Recargar
    showLoadingIndicator('🔄 Reiniciando sistema...');
    setTimeout(() => {
      location.reload();
    }, 1000);
  };

  console.log('🚀 SOCHIMT v3.0 cargado exitosamente!');
  console.log('');
  console.log('📋 COMANDOS DISPONIBLES:');
  console.log('┌─────────────────────────────────────────────┐');
  console.log('│ refreshNoticias() - Recargar noticias       │');
  console.log('│ forceCountersReset() - Reiniciar contadores │');
  console.log('│ forceInit() - Reinicialización completa     │');
  console.log('│ debugSOCHIMT() - Ver estado del sistema     │');
  console.log('│ testCommunication() - Test de comunicación  │');
  console.log('└─────────────────────────────────────────────┘');
  console.log('');
  console.log('🔧 SI HAY PROBLEMAS:');
  console.log('1. Ejecuta debugSOCHIMT() para ver el estado');
  console.log('2. Si las noticias no cargan: refreshNoticias()');
  console.log('3. Si los contadores no se mueven: forceCountersReset()');
  console.log('4. Si nada funciona: forceInit()');
  console.log('5. Para limpiar todo: resetSOCHIMT()');
  console.log('');
  console.log('📱 En móviles: Usa el botón azul flotante');
  console.log('🎯 Para debug rápido: Simplemente escribe debugSOCHIMT() en la consola');

  // Función de debug simple y clara
  window.debugSOCHIMT = function() {
    console.clear();
    console.log('🔍 DIAGNÓSTICO DEL SISTEMA SOCHIMT');
    console.log('════════════════════════════════════');
    
    // Estado básico
    console.log(`📱 Dispositivo: ${isMobile ? 'Móvil' : 'Desktop'}`);
    console.log(`🌐 Conexión: ${navigator.onLine ? 'Online' : 'Offline'}`);
    console.log(`💾 LocalStorage: ${typeof(Storage) !== "undefined" ? 'Disponible' : 'No disponible'}`);
    
    // Estado de noticias
    console.log(`📰 Noticias cargadas: ${noticiasLoaded ? '✅ Sí' : '❌ No'}`);
    const container = document.getElementById('noticias-container');
    const newsCount = container ? container.children.length : 0;
    console.log(`📊 Noticias en pantalla: ${newsCount}`);
    
    // Estado de contadores
    const allCounters = document.querySelectorAll('.counter');
    console.log(`🔢 Contadores encontrados: ${allCounters.length}`);
    
    if (allCounters.length > 0) {
      const counterValues = Array.from(allCounters).map(c => c.textContent);
      console.log(`📈 Valores actuales: [${counterValues.join(', ')}]`);
      
      const allZero = counterValues.every(v => v === '0');
      if (allZero) {
        console.log('⚠️ PROBLEMA: Todos los contadores están en 0');
        console.log('💡 SOLUCIÓN: Ejecuta forceCountersReset()');
      } else {
        console.log('✅ Los contadores parecen estar funcionando');
      }
    }
    
    // Estado de elementos críticos
    const criticalElements = [
      'noticias-container',
      'noticias-loading', 
      'stats-section',
      'stats-section-about'
    ];
    
    console.log('\n🏗️ ELEMENTOS CRÍTICOS:');
    criticalElements.forEach(id => {
      const element = document.getElementById(id);
      console.log(`  ${id}: ${element ? '✅ Encontrado' : '❌ Faltante'}`);
    });
    
    // Datos de localStorage
    const localData = getValidLocalStorageData();
    const syncMeta = getSyncMetadata();
    console.log(`\n💾 DATOS GUARDADOS:`);
    console.log(`  LocalStorage: ${localData ? localData.length + ' noticias' : 'Sin datos'}`);
    console.log(`  Sync Meta: ${syncMeta ? 'Disponible' : 'No disponible'}`);
    
    // Recomendaciones
    console.log('\n🎯 RECOMENDACIONES:');
    if (!noticiasLoaded) {
      console.log('  • Ejecuta refreshNoticias() para cargar noticias');
    }
    if (allCounters.length > 0 && Array.from(allCounters).every(c => c.textContent === '0')) {
      console.log('  • Ejecuta forceCountersReset() para animar contadores');
    }
    if (newsCount === 0) {
      console.log('  • Verifica que el elemento noticias-container exista');
    }
    
    console.log('\n✨ Sistema diagnosticado. Usa las recomendaciones para solucionar problemas.');
    
    return {
      mobile: isMobile,
      online: navigator.onLine,
      noticiasLoaded,
      newsCount,
      countersFound: allCounters.length,
      localStorage: !!localData,
      syncMeta: !!syncMeta
    };
  };

  // Función de inicialización manual forzada
  window.forceInit = function() {
    console.log('🔧 FORZANDO INICIALIZACIÓN COMPLETA...');
    
    try {
      // 1. Limpiar estado
      noticiasLoaded = false;
      countersAnimated = { hero: false, about: false };
      
      // 2. Forzar carga de noticias
      console.log('📰 Forzando carga de noticias...');
      const container = document.getElementById('noticias-container');
      const loading = document.getElementById('noticias-loading');
      
      if (loading) loading.style.display = 'none';
      if (container) {
        const defaultNews = getDefaultNoticias();
        renderNoticias(defaultNews);
        noticiasLoaded = true;
      }
      
      // 3. Forzar animación de contadores
      console.log('🔢 Forzando animación de contadores...');
      const allCounters = document.querySelectorAll('.counter');
      allCounters.forEach((counter, index) => {
        setTimeout(() => {
          counter.textContent = '0';
          animateCounter(counter);
        }, index * 300);
      });
      
      // 4. Inicializar UI elements
      initUIElements();
      
      console.log('✅ Inicialización forzada completada');
      showLoadingIndicator('✅ Sistema reinicializado', 'success');
      
    } catch (error) {
      console.error('❌ Error en inicialización forzada:', error);
      showLoadingIndicator('❌ Error en reinicialización', 'error');
    }
  };

  // Auto-diagnóstico inteligente y menos agresivo
  setTimeout(() => {
    const container = document.getElementById('noticias-container');
    const loading = document.getElementById('noticias-loading');
    
    // Si después de 8 segundos aún está cargando, ejecutar corrección automática
    if (loading && loading.style.display !== 'none' && !noticiasLoaded) {
      console.warn('⚠️ Detectado problema de carga después de 8 segundos');
      console.log('🔧 Ejecutando corrección automática...');
      showLoadingIndicator('🔧 Solucionando problema de carga...', 'info');
      
      setTimeout(() => {
        forceInit();
      }, 1000);
    }
    
  }, 8000); // Verificar después de 8 segundos

  // Verificar contadores por separado después de más tiempo
  setTimeout(() => {
    const allCounters = document.querySelectorAll('.counter');
    if (allCounters.length > 0) {
      const allZero = Array.from(allCounters).every(c => c.textContent === '0');
      if (allZero) {
        console.warn('⚠️ Contadores aún en 0 después de 12 segundos');
        console.log('🔢 Ejecutando animación de contadores...');
        showLoadingIndicator('🔢 Activando contadores...', 'info');
        forceCountersReset();
      }
    }
  }, 12000); // Verificar contadores después de 12 segundos

  // Cleanup al cerrar la página
  window.addEventListener('beforeunload', () => {
    console.log('🧹 Limpiando recursos...');
    
    if (broadcastChannel) {
      broadcastChannel.close();
      console.log('📡 BroadcastChannel cerrado');
    }
    
    if (autoSyncInterval) {
      clearInterval(autoSyncInterval);
      console.log('⏰ Intervalo de auto-sync limpiado');
    }
  });

  // Manejar errores globales
  window.addEventListener('error', (event) => {
    console.error('❌ Error global capturado:', event.error);
    
    // Intentar recuperación automática para errores relacionados con noticias
    if (event.error && event.error.message && 
        (event.error.message.includes('noticias') || event.error.message.includes('localStorage'))) {
      console.log('🔄 Intentando recuperación automática...');
      setTimeout(() => {
        loadNoticiasWithRetry();
      }, 1000);
    }
  });

  // Performance monitoring para desarrollo
  if (window.location.hostname === 'localhost' || window.location.hostname.includes('127.0.0.1')) {
    setTimeout(() => {
      const perfData = performance.getEntriesByType('navigation')[0];
      console.log('📊 Performance metrics:');
      console.log(`- DOM Content Loaded: ${Math.round(perfData.domContentLoadedEventEnd - perfData.domContentLoadedEventStart)}ms`);
      console.log(`- Load Complete: ${Math.round(perfData.loadEventEnd - perfData.loadEventStart)}ms`);
      console.log(`- Total Load Time: ${Math.round(perfData.loadEventEnd - perfData.fetchStart)}ms`);
    }, 1000);
  }
</script>

<style>
  /* Mejoras adicionales para líneas múltiples */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Mejoras para performance en móviles */
  @media (max-width: 768px) {
    .gradient-mesh {
      animation: none;
      background: linear-gradient(-45deg, #1e40af, #3b82f6);
    }
    
    .card-hover {
      transform: none;
    }
    
    .card-hover:hover {
      transform: translateY(-2px);
    }
    
    /* Forzar actualización en móviles */
    .mobile-refresh {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 1000;
      background: #2563eb;
      color: white;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
      cursor: pointer;
      display: none;
      transition: all 0.3s ease;
    }
    
    .mobile-refresh.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .mobile-refresh:hover {
      background: #1d4ed8;
      transform: scale(1.1);
    }

    .mobile-refresh.syncing {
      animation: spin 1s linear infinite;
    }
  }

  /* Indicador de estado de carga mejorado */
  .loading-indicator {
    position: fixed;
    top: 80px;
    right: 20px;
    background: rgba(37, 99, 235, 0.95);
    color: white;
    padding: 12px 20px;
    border-radius: 25px;
    font-size: 14px;
    font-weight: 600;
    z-index: 1000;
    opacity: 0;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 8px 32px rgba(37, 99, 235, 0.3);
  }
  
  .loading-indicator.show {
    opacity: 1;
    transform: translateY(0);
  }

  .loading-indicator.success {
    background: rgba(34, 197, 94, 0.95);
    box-shadow: 0 8px 32px rgba(34, 197, 94, 0.3);
  }

  .loading-indicator.error {
    background: rgba(239, 68, 68, 0.95);
    box-shadow: 0 8px 32px rgba(239, 68, 68, 0.3);
  }

  /* Indicador de sincronización */
  .sync-status {
    position: fixed;
    top: 20px;
    left: 20px;
    background: rgba(255, 255, 255, 0.95);
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    z-index: 1000;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    display: none;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
  }

  .sync-status.show {
    display: flex;
  }

  .sync-status .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    animation: pulse 2s infinite;
  }

  .sync-status .status-dot.connected {
    background: #10b981;
  }

  .sync-status .status-dot.syncing {
    background: #f59e0b;
    animation: pulse 0.5s infinite;
  }

  .sync-status .status-dot.disconnected {
    background: #ef4444;
  }

  /* Animaciones adicionales */
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  @keyframes slideInFromTop {
    from { 
      opacity: 0; 
      transform: translateY(-100%); 
    }
    to { 
      opacity: 1; 
      transform: translateY(0); 
    }
  }

  .slide-in-top {
    animation: slideInFromTop 0.5s ease-out;
  }

  /* Mejoras para elementos interactivos */
  .interactive-element {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .interactive-element:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
  }

  .interactive-element:active {
    transform: translateY(0);
  }

  /* Tooltip personalizado */
  .tooltip {
    position: relative;
    cursor: help;
  }

  .tooltip:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-size: 12px;
    white-space: nowrap;
    z-index: 1000;
    margin-bottom: 8px;
    opacity: 0;
    animation: fadeIn 0.3s ease-out forwards;
  }

  .tooltip:hover::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-top-color: rgba(0, 0, 0, 0.9);
    margin-bottom: 3px;
    opacity: 0;
    animation: fadeIn 0.3s ease-out forwards;
  }
</style>
</body>
</html>
